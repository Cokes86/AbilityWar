package daybreak.abilitywar.patch.list;

import com.earth2me.essentials.Essentials;
import com.earth2me.essentials.EssentialsConf;
import daybreak.abilitywar.patch.IPatch;
import java.io.File;
import org.bukkit.Bukkit;
import org.bukkit.ChatColor;
import org.bukkit.plugin.java.JavaPlugin;

public class EssentialsTeleportInvulnerability implements IPatch {

	public static final EssentialsTeleportInvulnerability instance = new EssentialsTeleportInvulnerability();

	private EssentialsTeleportInvulnerability() {
	}

	@Override
	public boolean condition() {
		return Bukkit.getPluginManager().getPlugin("Essentials") != null;
	}

	@Override
	public boolean isApplied() {
		return JavaPlugin.getPlugin(Essentials.class).getSettings().getTeleportInvulnerability() == 0;
	}

	@Override
	public void apply() {
		Essentials ess = JavaPlugin.getPlugin(Essentials.class);
		EssentialsConf config = new EssentialsConf(new File(ess.getDataFolder(), "config.yml"));
		config.setTemplateName("/config.yml");
		config.set("teleport-invulnerability", 0);
		ess.getSettings().reloadConfig();
	}

	@Override
	public String getName() {
		return "에센셜 텔레포트 무적";
	}

	@Override
	public String getMessage() {
		return ChatColor.WHITE + "텔레포트 무적: " + (isApplied() ? (ChatColor.GREEN + "0틱") : (ChatColor.RED.toString() + JavaPlugin.getPlugin(Essentials.class).getSettings().getTeleportInvulnerability() + "틱"));
	}

}
